:javascript
  $(function(){
    $('#player-select').selectize({
      valueField: 'slug',
      labelField: 'name',
      searchField: 'name',
      options: [],
      create: false,
      render: {
        option: function(item, escape) {
          return '<div class="suggestion">' +
            '<span class="name">' +
            escape(item.name) +
            // '#{content_tag(:i, nil, class: 'fas fa-star')}' +
            '</span>' +
            '<span class="years">' + escape(item.active_year_begin || '') + ' - ' + escape(item.active_year_end || '') + '</span>' +
          '</div>';
        }
      },

      highlight: false,
      maxItems: 1,
      persist: false,
      closeAfterSelect: true,
      openOnFocus: false,
      loadThrottle: 250,


      onChange: function(val) {
        if (val != '') {
          Turbolinks.visit("/players/" + val);
        }
      },

      onFocus: function() {
        var value = this.getValue();
        if (value.length > 0) {
          this.clear(true);
          // this.$control_input.val(value);
        }
      },

      load: function(query, callback) {
        if (!query.length) return callback();
        $.ajax({
          url: "#{players_path}?q=" + encodeURIComponent(query),
          type: 'GET',
          error: function() {
            callback();
          },
          success: function(res) {
            // console.log(res);
            callback(res);
          }
        });
      }
    });
  });


.selector
  %form
    -# %i.fa.fa-search
    = text_field_tag 'q', nil, placeholder: 'search for player', id: 'player-select', class: 'player-suggest', value: @player.try(:name)
